# =====================================================
# TEST DE GESTIÓ D'ERROS (CORRECTE)
# =====================================================
# IMPORTANT:
# - Només s'usa la variable @token.
# - Pega primer un token ADMIN en @token per als casos protegits.
# - Quan s'indique 403 USER, substituïx temporalment @token per token USER.

###
## LOGIN ADMIN (per obtenir token)
POST http://localhost:8090/api/v1/auth/login HTTP/1.1
Content-Type: application/json

{
  "username": "admin",
  "password": "password123"
}

###
## TOKEN ACTIU (posa ací el token que vulgues provar)
@token = 
###
## 400 - sort inválido en directors
GET http://localhost:8090/api/v1/directores?sort=campoInexistente,asc HTTP/1.1
Content-Type: application/json

###
## 400 - page negativa
GET http://localhost:8090/api/v1/directores?page=-31 HTTP/1.1
Content-Type: application/json

###
## 400 - size = 0
GET http://localhost:8090/api/v1/peliculas?size=0 HTTP/1.1
Content-Type: application/json

###
## 400 - validació body director (nombre buit)
POST http://localhost:8090/api/v1/directores HTTP/1.1
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "nombre": "",
  "nacionalidad": ""
}

###
## 400 - validació body pel·lícula (dades invàlides)
POST http://localhost:8090/api/v1/peliculas HTTP/1.1
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "titulo": "",
  "directorId": 1,
  "generoId": 1,
  "año": 1500,
  "duracion": 0
}



###
## 401/403 - sense token en endpoint protegit
POST http://localhost:8090/api/v1/generos HTTP/1.1
Content-Type: application/json

{
  "nombre": "SenseToken",
  "descripcion": "Ha de fallar per falta d'autenticació"
}

###
## LOGIN USER (per provar 403)
POST http://localhost:8090/api/v1/auth/login HTTP/1.1
Content-Type: application/json

{
  "username": "carlosm",
  "password": "password123"
}

###
@tokenUser = 

###
## 403 - amb token USER intentant POST (només ADMIN)
POST http://localhost:8090/api/v1/directores HTTP/1.1
Content-Type: application/json
Authorization: Bearer {{tokenUser}}

{
  "nombre": "mariano",
  "nacionalidad": "colombiano"
}



###
## 404 - director no existeix
GET http://localhost:8090/api/v1/directores/99999/info HTTP/1.1
Content-Type: application/json

###
## 404 - pel·lícula no existeix
GET http://localhost:8090/api/v1/peliculas/99999/info HTTP/1.1
Content-Type: application/json

###
## 404 - gènere no existeix
GET http://localhost:8090/api/v1/generos/66666 HTTP/1.1
Content-Type: application/json

###
## 404 - delete director no existeix (necessita token ADMIN)
DELETE http://localhost:8090/api/v1/directores/99999 HTTP/1.1
Content-Type: application/json
Authorization: Bearer {{token}}




###
## 409 - nom de gènere duplicat (necessita token ADMIN)
POST http://localhost:8090/api/v1/generos HTTP/1.1
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "nombre": "Acción",
  "descripcion": "Ha de fallar per unique"
}

###
## 409 - violació FK al borrar director amb pel·lícules (necessita token ADMIN)
DELETE http://localhost:8090/api/v1/directores/8 HTTP/1.1
Content-Type: application/json
Authorization: Bearer {{token}}
